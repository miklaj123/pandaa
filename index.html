<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Przetwarzanie danych z pliku CSV</title>
    <style>
        /* Twoje style */
    </style>
</head>
<body>
<div class="container">
    <h1>Przetwarzanie danych z pliku CSV</h1>
    <div>
        <input type="text" id="searchInput" placeholder="Wpisz zapytanie">
        <button onclick="searchInCsv()">Wyszukaj</button>
    </div>
    <div id="results"></div>
</div>

<script>
function searchInCsv() {
    const searchQuery = document.getElementById('searchInput').value.trim().toLowerCase();
    if (!searchQuery) {
        document.getElementById('results').innerText = 'Proszę wpisać zapytanie wyszukiwania.';
        return;
    }

    fetch('Pandabuy-Email.csv')
        .then(response => response.text())
        .then(csvText => {
            const lines = csvText.split('\n');
            const matchingLines = lines.filter(line => {
                const columns = line.split(',');
                // Sprawdzanie zgodności każdej kolumny z zapytaniem
                for (let i = 0; i < columns.length; i++) {
                    if (i === 2 && columns[i].toLowerCase().includes(searchQuery)) {
                        return true; // Kolumna 3 zawiera email
                    }
                    if (i === 3 && columns[i].toLowerCase().includes(searchQuery)) {
                        return true; // Kolumna 4 zawiera IP
                    }
                    if (i === 5 && columns[i].toLowerCase().includes(searchQuery)) {
                        return true; // Kolumna 6 zawiera miejsce
                    }
                    if ((i === 8 || i === 9) && columns[i].toLowerCase().includes(searchQuery)) {
                        return true; // Kolumny 9 i 10 zawierają miejsce
                    }
                    if (i === 10 && columns[i].includes(searchQuery)) {
                        return true; // Kolumna 11 zawiera telefon
                    }
                }
                return false;
            });
            displayResults(matchingLines);
        })
        .catch(error => {
            console.error('Błąd:', error);
            document.getElementById('results').innerText = 'Wystąpił błąd podczas ładowania danych.';
        });
}

function displayResults(results) {
    const resultsContainer = document.getElementById('results');
    if (results.length === 0) {
        resultsContainer.innerText = 'Nie znaleziono wyników.';
        return;
    }

    // Utwórz tabelę wyników
    const table = document.createElement('table');
    const headerRow = document.createElement('tr');
    headerRow.innerHTML = '<th>Email</th><th>IP</th><th>Miejsce</th><th>Miejsce 2</th><th>Miejsce 3</th><th>Telefon</th>';
    table.appendChild(headerRow);

    // Dodaj wiersze wyników
    results.forEach(line => {
        const columns = line.split(',');
        const row = document.createElement('tr');
        columns.forEach(column => {
            const cell = document.createElement('td');
            cell.textContent = column;
            row.appendChild(cell);
        });
        table.appendChild(row);
    });

    // Wyświetl tabelę wyników
    resultsContainer.innerHTML = '';
    resultsContainer.appendChild(table);
}
</script>
</body>
</html>
